{"version":3,"sources":["../scripts.babel/background.js"],"names":[],"mappings":"AAAA,YAAY,CAAC;;AAEb,IAAI,MAAM,GAAG,QAAQ,CAAC,cAAc,CAAC,QAAQ,CAAC,CAAC;;AAE/C,IAAI,QAAQ,GAAG,iCAAiC,CAAC;;AAEjD,IAAI,SAAS,GAAG;AACZ,kBAAgB,EAAE,MAAM;AACxB,oBAAkB,EAAE,QAAQ;AAC5B,oBAAkB,EAAE,QAAQ;AAC5B,oBAAkB,EAAE,QAAQ;AAC5B,mBAAiB,EAAE,OAAO;AAC1B,kBAAgB,EAAE,MAAM;CAC3B,CAAC;;AAEF,MAAM,CAAC,SAAS,CAAC,OAAO,CAAC,WAAW,CAAC,UAAC,SAAS,EAAE,OAAO,EAAE,YAAY,EAAK;AACzE,SAAO,CAAC,GAAG,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;AAC/B,MAAI,GAAG,GAAG,IAAI,cAAc,EAAE,CAAC;AAC/B,MAAI,MAAM,GAAG,UAAU,GAAG,SAAS,CAAC,OAAO,CAAC,SAAS,CAAC,CAAC;AACvD,QAAM,IAAI,QAAQ,GAAG,kBAAkB,CAAC,SAAS,CAAC,CAAC;AACnD,KAAG,CAAC,YAAY,GAAG,aAAa,CAAC;AACjC,KAAG,CAAC,MAAM,GAAG,YAAM;AACjB,QAAI,IAAI,GAAG,IAAI,IAAI,CAAC,CAAC,GAAG,CAAC,QAAQ,CAAC,EAAE,EAAC,IAAI,EAAE,WAAW,EAAC,CAAC,CAAC;AACzD,QAAI,MAAM,GAAG,GAAG,CAAC,eAAe,CAAC,IAAI,CAAC,CAAC;AACvC,UAAM,CAAC,GAAG,GAAG,MAAM,CAAC;AACpB,UAAM,CAAC,MAAM,GAAG,YAAM;AACpB,SAAG,CAAC,eAAe,CAAC,MAAM,CAAC,CAAC;KAC7B,CAAC;AACF,UAAM,CAAC,IAAI,EAAE,CAAC;AACd,gBAAY,CAAC,EAAC,MAAM,EAAE,OAAO,EAAC,CAAC,CAAC;AAChC,UAAM,CAAC,IAAI,EAAE,CAAC;GACf,CAAC;AACF,KAAG,CAAC,OAAO,GAAG,UAAC,CAAC,EAAK;AACnB,WAAO,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC;GAChB,CAAC;AACF,KAAG,CAAC,IAAI,CAAC,MAAM,EAAE,QAAQ,EAAE,IAAI,CAAC,CAAC;AACjC,KAAG,CAAC,gBAAgB,CAAC,cAAc,EAAE,mCAAmC,CAAC,CAAC;AAC1E,QAAM,CAAC,OAAO,CAAC,IAAI,CAAC,GAAG,CAAC,QAAQ,EAAE,UAAC,KAAK,EAAK;AAC3C,OAAG,CAAC,gBAAgB,CAAC,eAAe,EAAE,QAAQ,GAAG,IAAI,CAAC,KAAK,CAAC,MAAM,GAAG,GAAG,CAAC,CAAC,CAAC;AAC3E,OAAG,CAAC,IAAI,CAAC,MAAM,CAAC,CAAC;GAClB,CAAC,CAAC;CACJ,CAAC,CAAC;;AAEH,MAAM,CAAC,SAAS,CAAC,MAAM,CAAC,WAAW,CAAC,YAAM;AACxC,QAAM,CAAC,KAAK,EAAE,CAAC;CAChB,CAAC,CAAC","file":"background.js","sourcesContent":["'use strict';\n\nvar player = document.getElementById('player');\n\nvar ENDPOINT = 'https://api.voicetext.jp/v1/tts';\n\nvar VOICE_MAP = {\n    'VoiceText Show': 'show',\n    'VoiceText Haruka': 'haruka',\n    'VoiceText Hikari': 'hikari',\n    'VoiceText Takeru': 'takeru',\n    'VoiceText Santa': 'santa',\n    'VoiceText Bear': 'bear'\n};\n\nchrome.ttsEngine.onSpeak.addListener((utterance, options, sendTtsEvent) => {\n  console.log(options.voiceName);\n  var xhr = new XMLHttpRequest();\n  var params = 'speaker=' + VOICE_MAP[options.voiceName];\n  params += '&text=' + encodeURIComponent(utterance);\n  xhr.responseType = 'arraybuffer';\n  xhr.onload = () => {\n    var blob = new Blob([xhr.response], {type: 'audio/wav'});\n    var object = URL.createObjectURL(blob);\n    player.src = object;\n    player.onload = () => {\n      URL.revokeObjectURL(object);\n    };\n    player.load();\n    sendTtsEvent({'type': 'start'});\n    player.play();\n  };\n  xhr.onerror = (e) => {\n    console.log(e);\n  };\n  xhr.open('POST', ENDPOINT, true);\n  xhr.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');\n  chrome.storage.sync.get('apikey', (items) => {\n    xhr.setRequestHeader('Authorization', 'Basic ' + btoa(items.apikey + ':'));\n    xhr.send(params);\n  });\n});\n\nchrome.ttsEngine.onStop.addListener(() => {\n  player.pause();\n});\n"]}